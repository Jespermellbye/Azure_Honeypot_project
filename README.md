# Azure Honeypot Project

##  Purpose & Research Goal
This project demonstrates how to deploy and operate a simple honeypot in Microsoft Azure to collect, enrich and visualize real-world attack attempts. The honeypot consists of a single Windows virtual machine deliberately exposed to the internet (RDP open) to attract brute-force login attempts. Collected telemetry is shipped to a Log Analytics Workspace and ingested into Microsoft Sentinel where it is enriched with GeoIP data and visualized as an attack map.

### Scope and assumptions
- Lab-only setup: all resources are owned by the tester and run in an isolated subscription.  
- The VM is used for monitoring only (no production data).  
- GeoIP enrichment uses a static watchlist (geoip-summarized.csv); results depend on that dataset’s accuracy.  
- This is an IDS/logging exercise (not an active blocking IPS).

---

##  Step-by-Step Methodology (what was done and why)

### 1. Subscription and Resource Setup
- Created an Azure subscription and a dedicated resource group (`JM_SOC_Lab`) to isolate the experiment.  
- Why: Using a dedicated resource group makes it easier to keep track of all resources related to the honeypot. It also allows you to delete everything at once when the project is finished, which helps avoid unnecessary costs and prevents accidental exposure of production resources

### 2. Virtual Machine Deployment (the attack surface)
- Deployed a Windows VM named **CORP-Net-Middle** with a public IP (48.220.32.93).  
- Why: Windows machines with open RDP are one of the most commonly targeted systems on the internet. By creating such a machine, it becomes a realistic “bait” for automated scanners and brute-force attacks, making it ideal for collecting real-world attack data.

### 3. Network Security Group (NSG) configuration
- Configured the NSG to allow inbound RDP (3389/TCP) from any source.  
- Why: Allowing RDP from anywhere exposes the VM to the wider internet, which ensures that attackers can find and attempt to log in. This is unsafe for a production environment but useful for a honeypot because it attracts activity quickly.

### 4. Validating reachability
- Performed connectivity tests (ping, RDP connection attempts) to ensure the VM was reachable.  
- Why: Before analyzing attack logs, it is important to confirm that the VM is actually reachable. If connectivity is blocked, no real data would be collected. Testing ensures that any failed logins seen in the logs are genuine attempts from the internet.

### 5. Generating and Capturing Events
- Conducted controlled failed logins (`employee`) and confirmed Event ID 4625 appeared in Windows Security logs.  
- Why: Controlled failed logins help verify that the monitoring pipeline works correctly. By seeing Event ID 4625 appear, you confirm that authentication failures are captured. This gives confidence that real attacker activity will also be recorded

### 6. Centralized Logging via Log Analytics (LAW)
- Created a Log Analytics Workspace and installed the Azure Monitor Agent on the VM.  
- Why: LAW collects and stores logs in one central place, instead of leaving them only on the VM. Centralized storage makes it possible to run queries across multiple events, keep historical records, and prepare the data for use in Sentinel.


### 7. Microsoft Sentinel integration
- Enabled Sentinel and connected it to LAW. Configured the **Windows Security Events** connector via AMA.  
- Why: Sentinel acts as the SIEM (Security Information and Event Management) system. It allows you to query logs using KQL, set up alerts, and build dashboards. This turns raw log data into something analysts can easily understand and use to detect patterns or suspicious behavior.

### 8. GeoIP enrichment (watchlist)
- Imported `geoip-summarized.csv` as a Sentinel Watchlist and used `ipv4_lookup()` in KQL to convert IP addresses to city/country coordinates.  
- Why: Raw IP addresses are hard to interpret. By enriching them with geographic data, you can see which countries and regions are responsible for login attempts. This adds context to the analysis and makes it possible to present results visually on a map.

### 9. Attack Map workbook
- Built a workbook (map.json) in Sentinel to visualize failed login attempts by location and time.  
- Why: Seeing attack data on a map provides an immediate and intuitive understanding of the scale and origin of the attacks. It helps to identify clusters, spot repeated attackers from certain regions, and makes the findings more engaging and useful for reporting or presentations.

---

##  What this dataset represents
- The collected logs and PCAPs represent **unsolicited inbound traffic** that reached the honeypot VM while it was exposed.  
- This is *opportunistic* attack traffic — not traffic that was generated by our lab — and therefore it provides insight into real attacker behavior against exposed RDP endpoints.

Important notes about the dataset:
- The logs include IP addresses, timestamps, event types (4625), and sometimes user account names used during login attempts.  
- Raw PCAPs or logs may contain sensitive metadata. Treat them as potentially sensitive and follow anonymization guidelines before sharing.

---

##  Expected Analyses & Outcomes
By analyzing the collected data we can:
- Measure arrival time of first attacks after exposure.
- Identify top source IP addresses and their geolocation.
- Detect common username and password guessing patterns.
- Visualize attack volumes over time (time series) and geographically (attack map).
- Demonstrate how Azure tools (LAW + Sentinel + Watchlists) can form a simple, effective SOC pipeline.

---

##  Ethics, Safety & Data Handling
- The honeypot was deployed on Azure within a dedicated resource group owned by the researcher.  
- No production systems or third-party customer data were involved.  
- All raw logs and PCAP files are stored locally or within controlled Azure storage — not publicly shared.  
- Prior to any external sharing, IP addresses and other PII will be anonymized: truncation, hashing, or removal may be used depending on the audience.

If you plan to extend the project (longer data collection or sharing results), consider documenting retention policies, data deletion schedules, and a clear consent/ethics statement.

---

##  Cost & Operational Notes
- Azure compute and storage have billing implications. The chosen VM (`Standard_D2s_v3`) costs roughly $80–90/month if left running continuously.  
- Practical approach: create, test, collect data for a limited window (hours/days), then deallocate and delete resources to minimize costs.

---

##  Reproduction & Next Steps
To reproduce or extend this study:
1. Recreate the VM + NSG and LAW as described in the main README.  
2. Start packet capture or enable NSG flow logs for deeper analysis.  
3. Run KQL queries to extract Event ID 4625 and perform ipv4_lookup() against the watchlist.  
4. Aggregate and visualize results in a workbook.  
5. (Optional) Deploy additional honeypots with different services (SSH, HTTP) and compare attacker behavior.

---

##  Files included (placeholders)
- `screenshots/` – screenshots of VM, NSG, Event Viewer, Sentinel queries, attack map.  
- `logs/` – `nsg_flowlog.json`, `securityevents_4625.csv`, `geoip-summarized.csv` (watchlist).  
- `scripts/` – `az_commands.txt`, `kql_queries.txt`, `map.json`.  
- `figures/` – derived visualizations (geolocation map, top IPs, timelines).

--- 

##  Final note
The value of this project is not just in seeing that attacks occur — it is in using managed cloud tooling to **collect, enrich, and analyze real attack traffic quickly and reproducibly**. Azure gives a compact lab where SOC workflows can be practiced end-to-end without building complex on-prem infrastructure.
